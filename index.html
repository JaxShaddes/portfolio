<!DOCTYPE html>
<html lang="en" class="antialiased bg-[#f4f4f0] text-[#111]">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bruno Clemente — Graphic Design</title>
    <meta name="description" content="Senior Graphic Designer specializing in brutalist, typographic, and editorial design.">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        'off-white': '#f4f4f0',
                        'black': '#111111',
                        'accent': 'var(--accent-color, #FF3300)',
                        'gray-light': '#e5e5e5',
                    },
                    spacing: {
                        '128': '32rem',
                    }
                }
            }
        }
    </script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- GSAP & Lenis -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.4/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/lenis@1.0.45/dist/lenis.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --accent-color: #4b5670;
            --cursor-size: 20px;
        }
        
        body {
            cursor: none;
            overflow-x: hidden;
        }
        
        /* Custom Cursor */
        #cursor {
            position: fixed;
            top: 0;
            left: 0;
            width: var(--cursor-size);
            height: var(--cursor-size);
            background: var(--accent-color);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            mix-blend-mode: difference;
            transition: width 0.3s, height 0.3s, background-color 0.3s;
        }
        
        #cursor.hovered {
            width: 60px;
            height: 60px;
            background: white;
            mix-blend-mode: difference;
        }
        
        #cursor.hidden {
            opacity: 0;
        }

        /* Utility Classes */
        .grid-overlay {
            background-size: 100px 100px;
            background-image:
                linear-gradient(to right, rgba(0, 0, 0, 0.05) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
            pointer-events: none;
        }

        .clip-text {
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0% 100%);
        }

        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f4f4f0;
        }
        ::-webkit-scrollbar-thumb {
            background: #111;
            border: 2px solid #f4f4f0;
        }
        
        .loader-overlay {
            position: fixed;
            inset: 0;
            background: #111;
            color: #f4f4f0;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .page-enter {
            opacity: 0;
            transform: translateY(20px);
        }
        .page-enter-active {
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .page-exit {
            opacity: 1;
            transform: translateY(0);
        }
        .page-exit-active {
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <div id="cursor"></div>

    <script src="./data.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef, useLayoutEffect } = React;

        // --- DATA ---
        const LANG_KEY = "bc_lang";
        const SUPPORTED_LANGS = ["en", "pt"];

        const normalizeLang = (lang) => (SUPPORTED_LANGS.includes(lang) ? lang : "en");

        const getStoredLang = () => {
            try {
                const stored = localStorage.getItem(LANG_KEY);
                return SUPPORTED_LANGS.includes(stored) ? stored : null;
            } catch {
                return null;
            }
        };

        const setDocumentLang = (lang) => {
            const htmlLang = lang === "pt" ? "pt-PT" : "en";
            document.documentElement.setAttribute("lang", htmlLang);
            document.documentElement.setAttribute("data-lang", lang);
        };

                const DATA = window.PORTFOLIO_DATA || {};
        const COPY = DATA.copy || {};
        const FILTERS = DATA.filters || [];
        const MONTHS_SHORT = DATA.monthsShort || { en: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], pt: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"] };
        const PROJECTS_EN = (DATA.projects && DATA.projects.en) || [];
        const PROJECTS_PT = (DATA.projects && DATA.projects.pt) || [];
        const CLIENTS = DATA.clients || [];

        // --- COMPONENTS ---
        const Cursor = () => {
            useEffect(() => {
                const cursor = document.getElementById('cursor');
                const moveCursor = (e) => {
                    gsap.to(cursor, {
                        x: e.clientX,
                        y: e.clientY,
                        duration: 0.1,
                        ease: "power2.out"
                    });
                };
                const hoverEnter = () => cursor.classList.add('hovered');
                const hoverLeave = () => cursor.classList.remove('hovered');
                window.addEventListener('mousemove', moveCursor);
                const interactiveElements = document.querySelectorAll('a, button, .interactive');
                interactiveElements.forEach(el => {
                    el.addEventListener('mouseenter', hoverEnter);
                    el.addEventListener('mouseleave', hoverLeave);
                });
                return () => {
                    window.removeEventListener('mousemove', moveCursor);
                    interactiveElements.forEach(el => {
                        el.removeEventListener('mouseenter', hoverEnter);
                        el.removeEventListener('mouseleave', hoverLeave);
                    });
                };
            }, []);
            return null;
        };

        const useCursorHover = () => {
            useEffect(() => {
                const cursor = document.getElementById('cursor');
                const hoverEnter = () => cursor.classList.add('hovered');
                const hoverLeave = () => cursor.classList.remove('hovered');
                setTimeout(() => {
                    const interactiveElements = document.querySelectorAll('a, button, .interactive');
                    interactiveElements.forEach(el => {
                        el.addEventListener('mouseenter', hoverEnter);
                        el.addEventListener('mouseleave', hoverLeave);
                    });
                }, 100);
                return () => {
                    const interactiveElements = document.querySelectorAll('a, button, .interactive');
                    interactiveElements.forEach(el => {
                        el.removeEventListener('mouseenter', hoverEnter);
                        el.removeEventListener('mouseleave', hoverLeave);
                    });
                };
            }, []);
        };

        const Navigation = ({ currentPage, setPage, copy, lang, onLangChange }) => {
            const [isMenuOpen, setIsMenuOpen] = useState(false);

            const closeMenu = () => setIsMenuOpen(false);
            const handleNav = (nextPage) => {
                setPage(nextPage);
                closeMenu();
            };
            const handleLang = (nextLang) => {
                onLangChange(nextLang);
                closeMenu();
            };

            return (
                <nav className="fixed top-0 left-0 w-full z-50 flex justify-between items-center px-6 py-6 mix-blend-difference text-[#f4f4f0]">
                    <div className="font-display font-bold text-xl tracking-tighter uppercase cursor-pointer interactive hidden md:block" onClick={() => handleNav('home')}>
                        Bruno Clemente
                    </div>
                    <div className="font-display font-bold text-xl tracking-tighter uppercase cursor-pointer interactive md:hidden" onClick={() => handleNav('home')}>
                        BC
                    </div>
                    <div className="hidden md:flex gap-4 md:gap-8 font-sans text-xs md:text-sm uppercase tracking-widest">
                        <button 
                            className={`hover:text-accent transition-colors interactive ${currentPage === 'work' ? 'underline decoration-2 underline-offset-4' : ''}`}
                            onClick={() => handleNav('work')}
                        >
                            {copy.nav.work}
                        </button>
                        <button 
                            className={`hover:text-accent transition-colors interactive ${currentPage === 'about' ? 'underline decoration-2 underline-offset-4' : ''}`}
                            onClick={() => handleNav('about')}
                        >
                            {copy.nav.about}
                        </button>
                        <button 
                            className={`hover:text-accent transition-colors interactive ${currentPage === 'contact' ? 'underline decoration-2 underline-offset-4' : ''}`}
                            onClick={() => handleNav('contact')}
                        >
                            {copy.nav.contact}
                        </button>
                        <button className="hover:text-accent transition-colors interactive" onClick={() => { window.location.href = './client-portal.html'; closeMenu(); }} >
                            {copy.nav.clientPortal}
                        </button>   

                        <div className="flex items-center gap-2 border border-[#f4f4f0]/60 rounded-full px-2 py-1 ml-1">
                            <button
                                type="button"
                                className={`text-[10px] md:text-xs uppercase tracking-widest transition-colors interactive ${lang === 'en' ? 'underline decoration-2 underline-offset-4' : 'opacity-70 hover:opacity-100'}`}
                                onClick={() => handleLang('en')}
                            >
                                EN
                            </button>
                            <span className="opacity-50">/</span>
                            <button
                                type="button"
                                className={`text-[10px] md:text-xs uppercase tracking-widest transition-colors interactive ${lang === 'pt' ? 'underline decoration-2 underline-offset-4' : 'opacity-70 hover:opacity-100'}`}
                                onClick={() => handleLang('pt')}
                            >
                                PT
                            </button>
                        </div>
                    </div>

                    <button
                        type="button"
                        className="md:hidden font-sans text-xs uppercase tracking-widest border border-[#f4f4f0]/60 px-3 py-2 rounded-full interactive"
                        onClick={() => setIsMenuOpen(true)}
                    >
                        Menu
                    </button>

                    {isMenuOpen && (
                        <div className="fixed inset-0 z-[9999] md:hidden">
                            <div className="absolute inset-0 bg-black/70" onClick={closeMenu}></div>
                            <div className="absolute top-0 right-0 h-full w-[85%] max-w-xs bg-[#f4f4f0] text-[#111] border-l border-black shadow-[8px_0_0px_0px_rgba(0,0,0,1)] p-6 flex flex-col">
                                <div className="flex items-center justify-between mb-8">
                                    <div className="font-display text-xl uppercase">Menu</div>
                                    <button type="button" className="text-xs uppercase tracking-widest border border-black px-3 py-2 rounded-full" onClick={closeMenu}>
                                        Close
                                    </button>
                                </div>
                                <div className="flex flex-col gap-4 font-sans text-xs uppercase tracking-widest">
                                    <button className="text-left hover:text-accent transition-colors" onClick={() => handleNav('home')}>{copy.nav.home}</button>
                                    <button className="text-left hover:text-accent transition-colors" onClick={() => handleNav('work')}>{copy.nav.work}</button>
                                    <button className="text-left hover:text-accent transition-colors" onClick={() => handleNav('about')}>{copy.nav.about}</button>
                                    <button className="text-left hover:text-accent transition-colors" onClick={() => handleNav('contact')}>{copy.nav.contact}</button>
                                    <button className="text-left hover:text-accent transition-colors" onClick={() => { window.location.href = './client-portal.html'; closeMenu(); }}>{copy.nav.clientPortal}</button>
                                </div>
                                <div className="mt-8 flex items-center gap-3 border border-black/40 rounded-full px-3 py-2 w-fit">
                                    <button
                                        type="button"
                                        className={`text-[10px] uppercase tracking-widest ${lang === 'en' ? 'underline decoration-2 underline-offset-4' : 'opacity-70'}`}
                                        onClick={() => handleLang('en')}
                                    >
                                        EN
                                    </button>
                                    <span className="opacity-50">/</span>
                                    <button
                                        type="button"
                                        className={`text-[10px] uppercase tracking-widest ${lang === 'pt' ? 'underline decoration-2 underline-offset-4' : 'opacity-70'}`}
                                        onClick={() => handleLang('pt')}
                                    >
                                        PT
                                    </button>
                                </div>
                                <div className="mt-auto pt-6 text-xs uppercase tracking-widest opacity-60">Bruno Clemente</div>
                            </div>
                        </div>
                    )}
                </nav>
            );
        };

        const Marquee = ({ text, repeat = 4 }) => {
            const containerRef = useRef(null);
            useEffect(() => {
                const el = containerRef.current;
                gsap.to(el, {
                    xPercent: -50,
                    ease: "none",
                    duration: 20,
                    repeat: -1
                });
            }, []);
            return (
                <div className="w-full overflow-hidden bg-accent border-y border-black py-3">
                    <div className="flex whitespace-nowrap" ref={containerRef}>
                        {Array(repeat).fill(text).map((t, i) => (
                            <span key={i} className="font-display text-4xl font-bold uppercase mx-4 text-off-white">
                                {t} <span className="mx-4 text-white"></span>
                            </span>
                        ))}
                        {Array(repeat).fill(text).map((t, i) => (
                            <span key={`dup-${i}`} className="font-display text-4xl font-bold uppercase mx-4 text-off-white">
                                {t} <span className="mx-4 text-white"></span>
                            </span>
                        ))}
                    </div>
                </div>
            );
        };

        const Footer = ({ setPage, copy }) => {
            return (
                <footer className="w-full bg-black text-off-white py-20 px-6 mt-auto">
                    <div className="max-w-screen-2xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12">
                        <div className="flex flex-col gap-4">
                            <h3 className="font-display text-2xl font-bold uppercase">Bruno Clemente</h3>
                            <p className="font-sans text-sm text-gray-400">
                                {copy.footer.tagline}
                            </p>
                        </div>
                        <div>
                            <h4 className="font-sans text-xs uppercase tracking-widest mb-6 text-gray-500">{copy.footer.sitemap}</h4>
                            <ul className="flex flex-col gap-2 font-sans text-sm">
                                <li onClick={() => setPage('home')} className="cursor-pointer hover:text-accent interactive w-fit">{copy.nav.home}</li>
                                <li onClick={() => setPage('work')} className="cursor-pointer hover:text-accent interactive w-fit">{copy.nav.work}</li>
                                <li onClick={() => setPage('about')} className="cursor-pointer hover:text-accent interactive w-fit">{copy.nav.about}</li>
                                <li onClick={() => setPage('contact')} className="cursor-pointer hover:text-accent interactive w-fit">{copy.nav.contact}</li>
                            </ul>
                        </div>
                        <div>
                            <h4 className="font-sans text-xs uppercase tracking-widest mb-6 text-gray-500">{copy.footer.social}</h4>
                            <ul className="flex flex-col gap-2 font-sans text-sm">
                                <li className="cursor-pointer hover:text-accent interactive w-fit">Instagram</li>
                                <li className="cursor-pointer hover:text-accent interactive w-fit">Behance</li>
                                <li className="cursor-pointer hover:text-accent interactive w-fit">LinkedIn</li>
                            </ul>
                        </div>
                        <div>
                            <h4 className="font-sans text-xs uppercase tracking-widest mb-6 text-gray-500">{copy.footer.connect}</h4>
                            <a href="#" onClick={() => setPage('contact')} className="font-display text-3xl hover:text-accent transition-colors interactive underline decoration-1 underline-offset-4">
                                {copy.footer.letsTalk}
                            </a>
                        </div>
                    </div>
                    <div className="flex justify-between items-end mt-20 pt-8 border-t border-gray-800 font-sans text-xs text-gray-500">
                        <span>{copy.footer.rights}</span>
                        <span>{copy.footer.location}</span>
                    </div>
                </footer>
            );
        };

        const LanguageModal = ({ onSelect }) => {
            return (
                <div className="fixed inset-0 z-[11000] flex items-center justify-center bg-black/70 px-6">
                    <div className="w-full max-w-md border border-black bg-[#f4f4f0] p-6 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]">
                        <div className="font-display text-2xl uppercase tracking-tight mb-2">Choose your language</div>
                        <p className="text-sm opacity-70 mb-6">Escolha o idioma preferido</p>
                        <div className="flex flex-col gap-3">
                            <button type="button" onClick={() => onSelect("pt")} className="w-full px-4 py-3 border border-black bg-white hover:bg-black hover:text-white transition-colors font-sans text-xs uppercase tracking-widest interactive">
                                Português (Portugal)
                            </button>
                            <button type="button" onClick={() => onSelect("en")} className="w-full px-4 py-3 border border-black bg-white hover:bg-black hover:text-white transition-colors font-sans text-xs uppercase tracking-widest interactive">
                                English (International)
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // --- PAGES ---
        const HomePage = ({ setPage, copy, projects }) => {
            useCursorHover();
            const SELECTED_INDICES = [0, 2]; 
            const selectedProjects = projects.filter((_, index) => SELECTED_INDICES.includes(index));
            
            useEffect(() => {
                gsap.fromTo(".hero-text", 
                    { y: 100, opacity: 0 },
                    { y: 0, opacity: 1, duration: 1, stagger: 0.1, ease: "power4.out" }
                );
            }, []);

            return (
                <div className="min-h-screen pt-32 pb-20 px-6 max-w-screen-2xl mx-auto">
                    {/* Hero */}
                    <section className="mb-32 min-h-[60vh] flex flex-col justify-center">
                                                <h1 className="font-display text-5xl sm:text-6xl md:text-8xl lg:text-9xl font-bold leading-[0.85] tracking-tighter uppercase mb-12">

                            <div className="overflow-hidden"><span className="hero-text inline-block">{copy.home.heroLines[0]}</span></div>
                            <div className="overflow-hidden"><span className="hero-text inline-block text-transparent text-stroke-black" style={{WebkitTextStroke: '2px #111'}}>{copy.home.heroLines[1]}</span></div>
                            <div className="overflow-hidden"><span className="hero-text inline-block">{copy.home.heroLines[2]}</span></div>
                            <div className="overflow-hidden"><span className="hero-text inline-block">{copy.home.heroLines[3]}</span></div>
                        </h1>
                        <div className="max-w-xl ml-auto hero-text opacity-0">
                            <p className="font-sans text-lg md:text-xl leading-relaxed">
                                {copy.home.heroBody}
                            </p>
                        </div>
                    </section>

                    <div className="mb-32 -mx-6">
                        <Marquee text={copy.home.marquee} />
                    </div>

                    {/* Featured Work */}
                    <section className="mb-32">
                        <div className="flex justify-between items-end mb-12 border-b border-black pb-4">
                            <h2 className="font-display text-4xl font-bold uppercase">{copy.home.selectedWork}</h2>
                            <button onClick={() => setPage('work')} className="font-sans text-sm uppercase tracking-widest hover:text-accent interactive">{copy.home.viewAll}</button>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-16">
                            {selectedProjects.map((project, index) => (
                                <div key={project.slug} className="group cursor-pointer interactive" onClick={() => setPage('project', project.slug)}>
                                    <div className="relative aspect-[4/3] overflow-hidden bg-gray-200 mb-4">
                                        <img 
                                            src={project.coverImage} 
                                            alt={project.title}
                                            className="object-cover w-full h-full group-hover:scale-105 transition-transform duration-700 ease-out grayscale group-hover:grayscale-0"
                                        />
                                        <div className="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent pointer-events-none"></div>
                                    </div>
                                    <div className="flex justify-between items-start">
                                        <div>
                                            <h3 className="font-display text-2xl font-bold uppercase group-hover:text-accent transition-colors">{project.title}</h3>
                                            <span className="font-sans text-sm text-gray-500">{project.services.join(', ')}</span>
                                        </div>
                                        <span className="font-sans text-sm font-mono border border-black px-2 rounded-full">{project.year}</span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </section>

                    {/* Services/Philosophy */}
                    <section className="grid grid-cols-1 lg:grid-cols-2 gap-16 border-t border-black pt-16">
                        <div>
                            <h2 className="font-display text-4xl font-bold uppercase mb-8">{copy.home.approachTitle}</h2>
                        </div>
                        <div className="flex flex-col gap-8">
                            <p className="font-sans text-xl leading-relaxed">
                                {copy.home.approachBody}
                            </p>
                            <div className="grid grid-cols-2 gap-4 font-mono text-sm uppercase">
                                {copy.home.approachList.map(s => (
                                    <div key={s} className="border-b border-gray-300 pb-2">{s}</div>
                                ))}
                            </div>
                        </div>
                    </section>
                </div>
            );
        };

        const WorkPage = ({ setPage, copy, projects, lang }) => {
            const [filter, setFilter] = useState('all');
            useCursorHover();
            const getYear = (yearStr) => {
                const matches = yearStr.match(/(\d{4})/g);
                if (matches && matches.length > 0) {
                    return parseInt(matches[matches.length - 1]);
                }
                return 0;
            };
            const filteredProjects = filter === 'all' 
                ? projects 
                : projects.filter(p => p.tags.includes(filter));
            
            const getSortValue = (p) => {
                const year = getYear(p.year);
                const month = p.month || 0;
                return year * 100 + month;
            };
            const sortedProjects = [...filteredProjects].sort((a, b) => getSortValue(b) - getSortValue(a));
            const filters = FILTERS;

            return (
                <div className="min-h-screen pt-32 pb-20 px-6 max-w-screen-2xl mx-auto">
                    <div className="mb-16">
                        <h1 className="font-display text-6xl md:text-8xl font-bold uppercase mb-8">{copy.work.title}</h1>
                        <div className="flex flex-wrap gap-4">
                            {filters.map(f => (
                                <button 
                                    key={f.value}
                                    onClick={() => setFilter(f.value)}
                                    className={`font-sans text-sm uppercase tracking-widest border px-4 py-2 rounded-full transition-colors interactive ${filter === f.value ? 'bg-black text-white border-black' : 'border-black hover:bg-black hover:text-white'}`}
                                >
                                    {f.label[lang] || f.label.en}
                                </button>
                            ))}
                        </div>
                    </div>
                    <div className="grid grid-cols-1 gap-y-24">
                        {sortedProjects.map((project) => (
                            <div key={project.slug} className="group cursor-pointer interactive grid grid-cols-1 md:grid-cols-12 gap-8 items-center border-t border-gray-300 pt-8" onClick={() => setPage('project', project.slug)}>
                                <div className="md:col-span-5 order-2 md:order-1">
                                    <h2 className="font-display text-5xl font-bold uppercase mb-4 group-hover:text-accent transition-colors">{project.title}</h2>
                                    <div className="flex gap-4 font-mono text-sm mb-6 text-gray-500">
                                        <span>{project.client}</span>
                                        <span>—</span>
                                        <span>{project.year}</span>
                                    </div>
                                    <p className="font-sans text-lg leading-relaxed mb-8 max-w-md">
                                        {Array.isArray(project.description) ? project.description[0] : project.description}
                                    </p>
                                    <span className="font-sans text-sm uppercase underline decoration-1 underline-offset-4 group-hover:no-underline">{copy.work.viewCaseStudy}</span>
                                </div>
                                <div className="md:col-span-7 order-1 md:order-2 relative overflow-hidden">
                                    <img 
                                        src={project.coverImage} 
                                        alt={project.title}
                                        className="w-full h-[60vh] object-cover group-hover:scale-105 transition-transform duration-700 ease-out grayscale group-hover:grayscale-0"
                                    />
                                    <div className="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent pointer-events-none"></div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const ProjectDetail = ({ slug, setPage, copy, projects, lang }) => {
            useCursorHover();
            const project = projects.find(p => p.slug === slug);
            const [isExpanded, setIsExpanded] = useState(false);
            const months = MONTHS_SHORT[lang] || MONTHS_SHORT.en;
            
            const galleryRef = useRef(null);
            const rightColRef = useRef(null);

            useLayoutEffect(() => {
                setIsExpanded(false);
                if (window.gsap && window.ScrollTrigger) {
                    gsap.registerPlugin(ScrollTrigger);
                    const ctx = gsap.context(() => {
                        if (window.innerWidth >= 768 && rightColRef.current) {
                            gsap.to(rightColRef.current, {
                                y: -100,
                                ease: "none",
                                scrollTrigger: {
                                    trigger: galleryRef.current,
                                    start: "top bottom",
                                    end: "bottom top",
                                    scrub: true
                                }
                            });
                        }
                    }, galleryRef);
                    return () => ctx.revert();
                }
            }, [slug]);

            if (!project) return <div>{copy.project.notFound}</div>;

            const description = Array.isArray(project.description) ? project.description : [project.description];
            
            const leftImages = project.images.filter((_, i) => i % 2 === 0);
            const rightImages = project.images.filter((_, i) => i % 2 !== 0);

            const renderRole = () => {
                 if (Array.isArray(project.role)) {
                     return project.role.map(r => <li key={r}>{r}</li>);
                 }
                 return <li>{project.role || copy.project.defaultRole}</li>;
            };

            return (
                <div className="min-h-screen bg-off-white">
                    {/* Hero Image */}
                    <div className="h-[80vh] w-full relative overflow-hidden">
                        <img 
                            src={project.coverImage} 
                            className="w-full h-full object-cover"
                            alt={project.title}
                        />
                        <div className="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/30 pointer-events-none" />
                        <div className="absolute bottom-0 left-0 w-full p-6 bg-gradient-to-t from-black/50 to-transparent">
                            <h1 className="font-display text-6xl md:text-9xl font-bold uppercase text-white tracking-tighter">{project.title}</h1>
                        </div>
                    </div>

                    <div className="max-w-screen-2xl mx-auto px-6 py-20">
                        {/* Meta */}
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-12 border-b border-black pb-20 mb-20">
                            <div className="md:col-span-1">
                                <h3 className="font-mono text-xs uppercase text-gray-500 mb-2">{copy.project.client}</h3>
                                <p className="font-display text-xl uppercase font-bold">{project.client}</p>
                            </div>
                            <div className="md:col-span-1">
                                <h3 className="font-mono text-xs uppercase text-gray-500 mb-2">{copy.project.date}</h3>
                                <p className="font-display text-xl uppercase font-bold">
                                    {project.showMonth && project.month && (
                                        <span className="mr-2">{months[project.month - 1]}</span>
                                    )}
                                    {project.year}
                                </p>
                            </div>
                            <div className="md:col-span-1">
                                <h3 className="font-mono text-xs uppercase text-gray-500 mb-2">{copy.project.services}</h3>
                                <ul className="font-display text-xl uppercase font-bold">
                                    {project.services.map(s => <li key={s}>{s}</li>)}
                                </ul>
                            </div>
                             <div className="md:col-span-1">
                                <h3 className="font-mono text-xs uppercase text-gray-500 mb-2">{copy.project.role}</h3>
                                <ul className="font-display text-xl uppercase font-bold">
                                    {renderRole()}
                                </ul>
                            </div>
                        </div>

                        {/* Description */}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-16 mb-32">
                            <h2 className="font-display text-4xl font-bold uppercase">{copy.project.overview}</h2>
                            <div className="font-sans text-xl leading-relaxed space-y-6">
                                {description.slice(0, 2).map((para, i) => (
                                    <p key={`static-${i}`}>{para}</p>
                                ))}
                                
                                {isExpanded && description.slice(2).map((para, i) => (
                                    <p key={`extra-${i}`} className="page-enter-active">{para}</p>
                                ))}
                                
                                {description.length > 2 && (
                                    <button 
                                        onClick={() => setIsExpanded(!isExpanded)}
                                        className="text-sm uppercase font-bold tracking-widest border-b border-black pb-1 hover:text-accent interactive"
                                    >
                                        {isExpanded ? copy.project.readLess : copy.project.readMore}
                                    </button>
                                )}
                            </div>
                        </div>

                        {/* Gallery - Editorial Layout */}
                        <div ref={galleryRef} className="mb-32">
                            {/* Mobile: Standard Stack */}
                            <div className="md:hidden space-y-8">
                                {project.images.map((img, idx) => (
                                    <div key={idx} className="w-full">
                                        <img src={img} alt="" className="w-full h-auto" loading="lazy" />
                                    </div>
                                ))}
                            </div>

                            {/* Desktop: Parallax Columns */}
                            <div className="hidden md:grid grid-cols-2 gap-8 lg:gap-16 items-start">
                                {/* Left Column */}
                                <div className="flex flex-col gap-16 lg:gap-32">
                                    {leftImages.map((img, idx) => (
                                        <div key={`l-${idx}`} className="w-full">
                                            <img src={img} alt="" className="w-full h-auto" loading="lazy" />
                                        </div>
                                    ))}
                                </div>
                                {/* Right Column (Offset + Parallax) */}
                                <div ref={rightColRef} className="flex flex-col gap-16 lg:gap-32 pt-32 lg:pt-64">
                                    {rightImages.map((img, idx) => (
                                        <div key={`r-${idx}`} className="w-full">
                                            <img src={img} alt="" className="w-full h-auto" loading="lazy" />
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Next Project */}
                        <div className="border-t border-black pt-12 flex justify-between items-center">
                            <button onClick={() => setPage('work')} className="font-sans text-sm uppercase tracking-widest hover:text-accent interactive">{copy.project.backToWork}</button>
                        </div>
                    </div>
                </div>
            );
        };

        const AboutPage = ({ copy }) => {
            useCursorHover();
            return (
                <div className="min-h-screen pt-32 pb-20 px-6 max-w-screen-2xl mx-auto">
                    <div className="grid grid-cols-1 lg:grid-cols-12 gap-16">
                        <div className="lg:col-span-8">
                            <h1 className="font-display text-6xl md:text-9xl font-bold uppercase leading-[0.85] tracking-tighter mb-16">
                                {copy.about.titleLines[0]}<br/>{copy.about.titleLines[1]}<br/>{copy.about.titleLines[2]}
                            </h1>
                            <div className="prose prose-xl font-sans max-w-none mb-20">
                                <p>
                                    {copy.about.body1}
                                </p>
                                <p>
                                    {copy.about.body2}
                                </p>
                            </div>
                        </div>
                        <div className="lg:col-span-4 space-y-16">
                            <div>
                                <h3 className="font-display text-2xl font-bold uppercase border-b border-black pb-4 mb-6">{copy.about.clientsTitle}</h3>
                                <ul className="space-y-2 font-sans text-lg">
                                    {CLIENTS.map(c => <li key={c}>{c}</li>)}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const ContactPage = ({ copy }) => {
            useCursorHover();
            const [status, setStatus] = useState('idle'); 

            const handleSubmit = (e) => {
                e.preventDefault();
                setStatus('submitting');
                
                const formData = new FormData(e.target);

                fetch("https://formsubmit.co/ajax/41be71d64fb293e4cd6013f81cb8467f", {
                method: "POST",
                body: formData,
                headers: {
                    "Accept": "application/json"
                }
            })
        .then(response => {
    if (!response.ok) throw new Error(`HTTP ${response.status}`);
    return response.json();
})
.then(data => {
    setStatus('success');
})
.catch(error => {
    console.log(error);
    setStatus('error');
});
                
            };

            return (
                <div className="min-h-screen pt-32 pb-20 px-6 max-w-screen-2xl mx-auto flex flex-col justify-center">
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-16">
                        <div>
                            <h1 className="font-display text-6xl md:text-8xl font-bold uppercase leading-[0.85] tracking-tighter mb-8">
                                {copy.contact.titleLines[0]}<br/>{copy.contact.titleLines[1]}<br/>{copy.contact.titleLines[2]}
                            </h1>
                            <p className="font-sans text-xl mb-8">
                                {copy.contact.subtitle} <br/>
                            </p>
                            <a href="mailto:contact@jbclemente.pt" className="font-mono text-lg hover:text-accent interactive">work@jbclemente.pt</a>
                        </div>

                        <div className="bg-white p-8 border border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]">
                            {status === 'success' ? (
                                <div className="h-full flex flex-col items-center justify-center text-center py-20">
                                    <h3 className="font-display text-4xl font-bold uppercase mb-4">{copy.contact.form.successTitle}</h3>
                                    <p className="font-sans">{copy.contact.form.successBody}</p>
                                    <button onClick={() => setStatus('idle')} className="mt-8 text-sm underline interactive">{copy.contact.form.sendAnother}</button>
                                </div>
                            ) : (
                                <form onSubmit={handleSubmit} className="flex flex-col gap-6">
                                    <input type="text" name="_honey" style={{display: 'none'}} />
                                    <input type="hidden" name="_captcha" value="false" />
                                    
                                    <div>
                                        <label className="block font-mono text-xs uppercase mb-2">{copy.contact.form.nameLabel}</label>
                                        <input type="text" name="name" required className="w-full border-b border-gray-300 py-2 focus:outline-none focus:border-black bg-transparent font-sans text-lg transition-colors" placeholder={copy.contact.form.namePlaceholder} />
                                    </div>
                                    <div>
                                        <label className="block font-mono text-xs uppercase mb-2">{copy.contact.form.emailLabel}</label>
                                        <input type="email" name="email" required className="w-full border-b border-gray-300 py-2 focus:outline-none focus:border-black bg-transparent font-sans text-lg transition-colors" placeholder={copy.contact.form.emailPlaceholder} />
                                    </div>
                                    <div>
                                        <label className="block font-mono text-xs uppercase mb-2">{copy.contact.form.projectLabel}</label>
                                        <textarea rows="4" name="message" required className="w-full border-b border-gray-300 py-2 focus:outline-none focus:border-black bg-transparent font-sans text-lg transition-colors resize-none" placeholder={copy.contact.form.messagePlaceholder}></textarea>
                                    </div>
                                    <button type="submit" disabled={status === 'submitting'} className="mt-4 bg-black text-white font-display font-bold uppercase py-4 px-8 hover:bg-accent transition-colors interactive disabled:opacity-50">
                                        {status === 'submitting' ? copy.contact.form.sending : copy.contact.form.send}
                                    </button>
                                    {status === 'error' && <p className="text-red-500 text-sm">{copy.contact.form.error}</p>}
                                </form>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // 4. App Shell
        const App = () => {
            const [page, setPageState] = useState('home');
            const [slug, setSlug] = useState(null);
            const [loading, setLoading] = useState(true);
            const storedLang = getStoredLang();
            const [lang, setLang] = useState(storedLang || "en");
            const [hasLangPref, setHasLangPref] = useState(!!storedLang);
            const copy = COPY[lang] || COPY.en;
            const projects = lang === "pt" ? PROJECTS_PT : PROJECTS_EN;
            
            //Lenis instance storage
            const lenisInstance = useRef(null);

            useEffect(() => {
                setDocumentLang(lang);
                if (hasLangPref) {
                    try {
                        localStorage.setItem(LANG_KEY, lang);
                    } catch {}
                }
                const meta = document.querySelector('meta[name="description"]');
                if (meta) meta.setAttribute('content', copy.meta.description);
                document.title = copy.meta.title;
            }, [lang, hasLangPref, copy]);

            useEffect(() => {
                if (!hasLangPref) {
                    document.body.style.overflow = "hidden";
                } else {
                    document.body.style.overflow = "";
                }
                return () => { document.body.style.overflow = ""; };
            }, [hasLangPref]);

            // Initialize Lenis ONCE
            useEffect(() => {
                const lenis = new Lenis({
                    duration: 1.2,
                    easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
                    direction: 'vertical',
                    gestureDirection: 'vertical',
                    smooth: true,
                    mouseMultiplier: 1,
                    smoothTouch: false,
                    touchMultiplier: 2,
                });
                lenisInstance.current = lenis;
                function raf(time) {
                    lenis.raf(time);
                    requestAnimationFrame(raf);
                }
                requestAnimationFrame(raf);
                return () => lenis.destroy();
            }, []);

            // 🔥 FORCE SCROLL TO TOP ON ANY NAVIGATION
            useEffect(() => {
                if (lenisInstance.current) {
                    lenisInstance.current.scrollTo(0, { behavior: 'auto' }); // Instant to top
                } else {
                    window.scrollTo(0, 0); // Fallback
                }
            }, [page, slug]); // Triggers on project open/close

            // Initial Loader
            useEffect(() => {
                const timer = setTimeout(() => setLoading(false), 1500);
                return () => clearTimeout(timer);
            }, []);

            const setPage = (newPage, newSlug = null) => {
                setSlug(newSlug);
                setPageState(newPage);
            };

            const handleSelectLang = (nextLang) => {
                const normalized = normalizeLang(nextLang);
                setLang(normalized);
                setHasLangPref(true);
                try {
                    localStorage.setItem(LANG_KEY, normalized);
                } catch {}
            };

            const [progress, setProgress] = useState(0);

            useEffect(() => {
                const interval = setInterval(() => {
                    setProgress(prev => {
                        if (prev >= 100) {
                            clearInterval(interval);
                            setTimeout(() => setLoading(false), 500);
                            return 100;
                        }
                        return prev + Math.floor(Math.random() * 15) + 1;
                    });
                }, 150);
                return () => clearInterval(interval);
            }, []);

            if (loading) {
                return (
                    <div className="loader-overlay">
                        <div className="w-64 h-[1px] bg-gray-800 mb-4 relative overflow-hidden">
                            <div className="absolute top-0 left-0 h-full bg-[#f4f4f0] transition-all duration-200 ease-out" style={{ width: `${progress}%` }}></div>
                        </div>
                        <h1 className="font-display text-8xl font-bold uppercase tracking-tighter">
                            {Math.min(progress, 100)}%
                        </h1>
                    </div>
                );
            }

            return (
                <div className="min-h-screen flex flex-col relative">
                    <div className="fixed inset-0 grid-overlay opacity-30 pointer-events-none z-0 h-full w-full"></div>
                    
                    <Cursor />
                    <Navigation currentPage={page} setPage={setPage} copy={copy} lang={lang} onLangChange={handleSelectLang} />
                    
                    <main className="flex-grow z-10">
                        {page === 'home' && <HomePage setPage={setPage} copy={copy} projects={projects} />}
                        {page === 'work' && <WorkPage setPage={setPage} copy={copy} projects={projects} lang={lang} />}
                        {page === 'about' && <AboutPage copy={copy} />}
                        {page === 'contact' && <ContactPage copy={copy} />}
                        {page === 'project' && <ProjectDetail slug={slug} setPage={setPage} copy={copy} projects={projects} lang={lang} />}
                    </main>

                    <Footer setPage={setPage} copy={copy} />
                    {!hasLangPref && <LanguageModal onSelect={handleSelectLang} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

